{"version":3,"file":"author-datalist.es5.js","sources":["../src/element.js"],"sourcesContent":["class AuthorDatalistElement extends AuthorMenuElement {\n  constructor () {\n    super(`{{TEMPLATE-STRING}}`)\n\n    this.UTIL.defineProperties({\n      clickCount: {\n        private: true,\n        default: 0\n      }\n    })\n\n    this.UTIL.definePrivateMethods({\n      find: query => (Array.from(this.options).filter(option => {\n        let value = this.hasAttribute('case-sensitive') ? option.value : option.value.toLowerCase()\n        let text = this.hasAttribute('case-sensitive') ? option.text : option.text.toLowerCase()\n        query = this.hasAttribute('case-sensitive') ? query : query.toLowerCase()\n\n        return value.indexOf(query) >= 0 || text.indexOf(query) >= 0\n      })),\n\n      hideAllOptions: () => Array.from(this.options).forEach(option => option.setAttribute('hidden', '')),\n\n      inputFocusHandler: evt => {\n        this.inputElement.addEventListener('keydown', this.PRIVATE.inputKeydownHandler)\n      },\n\n      inputKeydownHandler: evt => {\n        if (!this.open) {\n          this.PRIVATE.showAllOptions()\n          this.open = true\n          return\n        }\n\n        this.PRIVATE.keydownHandler(evt)\n      },\n\n      showAllOptions: () => Array.from(this.options).forEach(option => option.removeAttribute('hidden'))\n    })\n\n    this.UTIL.registerListeners(this, {\n      connected: () => {\n        this.inputElement.addEventListener('focus', this.PRIVATE.inputFocusHandler)\n\n        this.UTIL.registerListeners(this.inputElement, {\n          blur: evt => {\n            this.PRIVATE.clickCount = 0\n            this.inputElement.removeEventListener('keydown', this.PRIVATE.inputKeydownHandler)\n          },\n\n          click: evt => {\n            this.PRIVATE.clickCount++\n\n            if (this.PRIVATE.clickCount === 2) {\n              this.PRIVATE.showAllOptions()\n              this.open = true\n            }\n          },\n\n          input: evt => {\n            this.PRIVATE.hideAllOptions()\n            let query = this.inputElement.value\n\n            if (!query) {\n              return\n            }\n\n            let results = this.PRIVATE.find(query)\n\n            if (results.length) {\n              results.forEach(result => result.removeAttribute('hidden'))\n              this.open = true\n              return\n            }\n\n            if (this.open) {\n              this.open = false\n            }\n\n            this.PRIVATE.hideAllOptions()\n          }\n        })\n      },\n\n      disconnected: () => {\n        this.inputElement.removeEventListener('focus', this.PRIVATE.inputFocusHandler)\n      },\n\n      'options.selected': evt => this.inputElement.value = evt.detail.options[0].value\n    })\n  }\n\n  static get observedAttributes () {\n    return [...AuthorMenuElement.observedAttributes, 'case-sensitive']\n  }\n\n  get value () {\n    return this.inputElement.value\n  }\n\n  add (option, index) {\n    this.optionsElement.addOption(option, index)\n    // if (!customElements.get('author-option')) {\n    //   return console.error(`author-datalist requires author-option. Please include it in this document's <head> element.`)\n    // }\n    //\n    // if (!option.hasOwnProperty('id')) {\n    //   option.id = this.PRIVATE.generateGuid('option')\n    // }\n    //\n    // if (!option.hasOwnProperty('sourceElement') || !(option.sourceElement instanceof HTMLElement)) {\n    //   let sourceEl = document.createElement('option')\n    //\n    //   if (option.hasOwnProperty('innerHTML')) {\n    //     sourceEl.innerHTML = option.innerHTML\n    //   }\n    //\n    //   if (option.hasOwnProperty('label')) {\n    //     sourceEl.innerHTML = option.label\n    //   }\n    //\n    //   if (option.hasOwnProperty('value')) {\n    //     sourceEl.value = option.value\n    //   }\n    //\n    //   if (option.hasOwnProperty('disabled')) {\n    //     sourceEl.disabled = typeof option.disabled === 'boolean' && option.disabled\n    //   }\n    //\n    //   option.sourceElement = sourceEl\n    // }\n    //\n    // let label = option.sourceElement.getAttribute('label') || option.sourceElement.textContent.trim()\n    // let value = option.sourceElement.getAttribute('value')\n    // let disabled = option.sourceElement.disabled\n    // let authorOption = document.createElement('author-option')\n    //\n    // authorOption.style.display = 'none'\n    // authorOption.key = option.id\n    // authorOption.innerHTML = option.sourceElement.innerHTML\n    //\n    // dest.appendChild(authorOption)\n    // authorOption.addEventListener('click', evt => this.select(authorOption.key))\n    //\n    // option = {\n    //   attributes: { disabled, label, value },\n    //   id: option.id,\n    //   displayElement: authorOption,\n    //   sourceElement: option.sourceElement\n    // }\n    //\n    // if (index) {\n    //   this[`${index}`] = option.sourceElement\n    //   this.options.splice(index, 0, option)\n    //   return\n    // }\n    //\n    // this[`${this.options.length}`] = option.sourceElement\n    // this.options.push(option)\n  }\n\n  inject (input, datalist, guid) {\n    // Prevent re-injections\n    if (this.PRIVATE.injected) {\n      return\n    }\n\n    input.slot = 'input'\n    input.id = guid\n\n    this.UTIL.defineProperty('inputElement', {\n      readonly: true,\n      default: input\n    })\n\n    this.appendChild(this.inputElement)\n    super.inject(datalist)\n  }\n}\n\ncustomElements.define('author-datalist', AuthorDatalistElement)\n\nexport default AuthorDatalistElement\n"],"names":["AuthorDatalistElement","UTIL","defineProperties","clickCount","private","default","definePrivateMethods","find","query","Array","from","options","filter","option","value","hasAttribute","toLowerCase","text","indexOf","hideAllOptions","forEach","setAttribute","inputFocusHandler","evt","inputElement","addEventListener","PRIVATE","inputKeydownHandler","open","showAllOptions","keydownHandler","removeAttribute","registerListeners","connected","blur","removeEventListener","click","input","results","length","result","disconnected","detail","index","optionsElement","addOption","datalist","guid","injected","slot","id","defineProperty","readonly","appendChild","AuthorMenuElement","observedAttributes","customElements","define"],"mappings":"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"}