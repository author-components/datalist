{"version":3,"file":"author-datalist.es5.js","sources":["../src/element.js"],"sourcesContent":["class AuthorDatalistElement extends AuthorMenuElement {\n  constructor () {\n    super(`{{TEMPLATE-STRING}}`)\n\n    this.UTIL.defineAttributes({\n      'case-sensitive': false\n    })\n\n    this.UTIL.definePrivateMethods({\n      hideAllOptions: () => Array.from(this.options).forEach(option => option.setAttribute('hidden', '')),\n\n      clearFilter: () => {\n        if (this.optionsElement.hasFilter('query')) {\n          this.optionsElement.removeFilter('query')\n          this.selectedIndex = -1\n        }\n      },\n\n      filterInput: () => {\n        this.PRIVATE.clearFilter()\n\n        let query = this.inputElement.value\n\n        if (!query || query === '') {\n          this.PRIVATE.showAllOptions()\n          return this.PRIVATE.clearFilter()\n        }\n\n        this.optionsElement.addFilter('query', () => {\n          let results = this.optionsElement.find(query, this['case-sensitive'])\n\n          if (results.length) {\n            return results\n          }\n\n          return this.options\n        })\n\n        this.PRIVATE.hideAllOptions()\n\n        if (this.optionsElement.filteredOptions.length > 0) {\n          this.optionsElement.filteredOptions.forEach(option => option.hidden = false)\n          this.open = true\n        } else {\n          this.open = false\n        }\n      },\n\n      inputKeydownHandler: evt => {\n        switch (evt[this.keySource]) {\n          case 13:\n          case 'Enter':\n          case 27:\n          case 'Escape':\n          case 38:\n          case 'ArrowUp':\n          case 40:\n          case 'ArrowDown':\n            break\n\n          case 32:\n          case ' ':\n            return\n\n          case 8:\n          case 'Backspace':\n            if (this.inputElement.value.length === 1) {\n              this.open = false\n            }\n\n            break\n        }\n\n        this.PRIVATE.keydownHandler(evt)\n      },\n\n      showAllOptions: () => Array.from(this.options).forEach(option => option.removeAttribute('hidden'))\n    })\n\n    this.UTIL.registerListeners(this, {\n      connected: () => {\n        this.UTIL.registerListeners(this, {\n          focus: evt => {\n            if (document.activeElement === this) {\n              this.inputElement.focus()\n              return evt.stopImmediatePropagation()\n            }\n\n            this.inputElement.addEventListener('keydown', this.PRIVATE.inputKeydownHandler)\n          }\n        })\n\n        this.UTIL.registerListeners(this.inputElement, {\n          blur: evt => {\n            this.inputElement.removeEventListener('keydown', this.PRIVATE.inputKeydownHandler)\n            this.emit('blur')\n          },\n\n          focus: evt => this.emit('focus'),\n\n          click: evt => this.open = true,\n\n          input: evt => {\n            this.PRIVATE.filterInput(evt)\n\n            if (evt.inputType.includes('delete')) {\n              this.optionsElement.unHoverAllOptions()\n            }\n          }\n        })\n\n        this.UTIL.registerListeners(window, {\n          scroll: evt => this.open = false\n        })\n      },\n\n      'options.selected': evt => {\n        let option = evt.detail.options[0]\n        this.inputElement.value = option.value\n        this.PRIVATE.filterInput()\n        this.emit('option.selected', option.displayElement)\n        this.open = false\n      },\n\n      'state.change': evt => {\n        if (evt.detail.name === 'open' && evt.detail.value && this.inputElement.value === '') {\n          this.optionsElement.unHoverAllOptions()\n        }\n      }\n    })\n  }\n\n  static get observedAttributes () {\n    return [...AuthorMenuElement.observedAttributes, 'case-sensitive']\n  }\n\n  get value () {\n    return this.inputElement.value\n  }\n\n  add (option, index) {\n    this.optionsElement.addOption(option, index)\n  }\n\n  addFilter (key, func) {\n    this.optionsElement.addFilter(key, func)\n  }\n\n  clear () {\n    this.inputElement.value = ''\n    this.selectedIndex = -1\n    this.PRIVATE.showAllOptions()\n  }\n\n  focus () {\n    this.inputElement.focus()\n  }\n\n  inject (input, select, guid) {\n    // Prevent re-injections\n    if (this.PRIVATE.injected) {\n      return\n    }\n\n    input.slot = 'input'\n    input.id = guid\n\n    this.UTIL.defineProperty('inputElement', {\n      readonly: true,\n      default: input\n    })\n\n    this.appendChild(this.inputElement)\n    super.inject(select)\n  }\n}\n\ncustomElements.define('author-datalist', AuthorDatalistElement)\n\nexport default AuthorDatalistElement\n"],"names":["AuthorDatalistElement","UTIL","defineAttributes","definePrivateMethods","hideAllOptions","Array","from","options","forEach","option","setAttribute","clearFilter","optionsElement","hasFilter","removeFilter","selectedIndex","filterInput","PRIVATE","query","inputElement","value","showAllOptions","addFilter","results","find","length","filteredOptions","hidden","open","inputKeydownHandler","evt","keySource","keydownHandler","removeAttribute","registerListeners","connected","focus","document","activeElement","stopImmediatePropagation","addEventListener","blur","removeEventListener","emit","click","input","inputType","includes","unHoverAllOptions","window","scroll","detail","displayElement","name","index","addOption","key","func","select","guid","injected","slot","id","defineProperty","readonly","default","appendChild","AuthorMenuElement","observedAttributes","customElements","define"],"mappings":"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"}