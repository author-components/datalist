{"version":3,"file":"author-datalist.min.js","sources":["../src/element.js"],"sourcesContent":["class AuthorDatalistElement extends AuthorMenuElement {\n  constructor () {\n    super(`{{TEMPLATE-STRING}}`)\n\n    this.UTIL.defineAttributes({\n      'case-sensitive': false\n    })\n\n    this.UTIL.definePrivateMethods({\n      hideAllOptions: () => Array.from(this.options).forEach(option => option.setAttribute('hidden', '')),\n\n      clearFilter: () => {\n        if (this.optionsElement.hasFilter('query')) {\n          this.optionsElement.removeFilter('query')\n          this.selectedIndex = -1\n        }\n      },\n\n      filterInput: () => {\n        this.PRIVATE.clearFilter()\n\n        let query = this.inputElement.value\n\n        if (!query || query === '') {\n          this.PRIVATE.showAllOptions()\n          return this.PRIVATE.clearFilter()\n        }\n\n        this.optionsElement.addFilter('query', () => {\n          let results = this.optionsElement.find(query, this['case-sensitive'])\n\n          if (results.length) {\n            return results\n          }\n\n          return this.options\n        })\n\n        this.PRIVATE.hideAllOptions()\n\n        if (this.optionsElement.filteredOptions.length > 0) {\n          this.optionsElement.filteredOptions.forEach(option => option.hidden = false)\n          this.open = true\n        } else {\n          this.open = false\n        }\n      },\n\n      inputKeydownHandler: evt => {\n        switch (evt[this.keySource]) {\n          case 13:\n          case 'Enter':\n          case 27:\n          case 'Escape':\n          case 38:\n          case 'ArrowUp':\n          case 40:\n          case 'ArrowDown':\n            break\n\n          case 32:\n          case ' ':\n            return\n\n          case 8:\n          case 'Backspace':\n            if (this.inputElement.value.length === 1) {\n              this.open = false\n            }\n\n            break\n        }\n\n        this.PRIVATE.keydownHandler(evt)\n      },\n\n      showAllOptions: () => Array.from(this.options).forEach(option => option.removeAttribute('hidden'))\n    })\n\n    this.UTIL.registerListeners(this, {\n      connected: () => {\n        this.UTIL.registerListeners(this, {\n          focus: evt => {\n            if (document.activeElement === this) {\n              this.inputElement.focus()\n              return evt.stopImmediatePropagation()\n            }\n\n            this.inputElement.addEventListener('keydown', this.PRIVATE.inputKeydownHandler)\n          }\n        })\n\n        this.UTIL.registerListeners(this.inputElement, {\n          blur: evt => {\n            this.inputElement.removeEventListener('keydown', this.PRIVATE.inputKeydownHandler)\n            this.emit('blur')\n          },\n\n          focus: evt => this.emit('focus'),\n\n          click: evt => this.open = true,\n\n          input: evt => {\n            this.PRIVATE.filterInput(evt)\n\n            if (evt.inputType.includes('delete')) {\n              this.optionsElement.unHoverAllOptions()\n            }\n          }\n        })\n\n        this.UTIL.registerListeners(window, {\n          scroll: evt => this.open = false\n        })\n      },\n\n      'options.selected': evt => {\n        let option = evt.detail.options[0]\n        this.inputElement.value = option.value\n        this.PRIVATE.filterInput()\n        this.emit('option.selected', option.displayElement)\n        this.open = false\n      },\n\n      'state.change': evt => {\n        if (evt.detail.name === 'open' && evt.detail.value && this.inputElement.value === '') {\n          this.optionsElement.unHoverAllOptions()\n        }\n      }\n    })\n  }\n\n  static get observedAttributes () {\n    return [...AuthorMenuElement.observedAttributes, 'case-sensitive']\n  }\n\n  get value () {\n    return this.inputElement.value\n  }\n\n  add (option, index) {\n    this.optionsElement.addOption(option, index)\n  }\n\n  addFilter (key, func) {\n    this.optionsElement.addFilter(key, func)\n  }\n\n  clear () {\n    this.inputElement.value = ''\n    this.selectedIndex = -1\n    this.PRIVATE.showAllOptions()\n  }\n\n  focus () {\n    this.inputElement.focus()\n  }\n\n  inject (input, select, guid) {\n    // Prevent re-injections\n    if (this.PRIVATE.injected) {\n      return\n    }\n\n    input.slot = 'input'\n    input.id = guid\n\n    this.UTIL.defineProperty('inputElement', {\n      readonly: true,\n      default: input\n    })\n\n    this.appendChild(this.inputElement)\n    super.inject(select)\n  }\n}\n\ncustomElements.define('author-datalist', AuthorDatalistElement)\n\nexport default AuthorDatalistElement\n"],"names":["AuthorDatalistElement","AuthorMenuElement","[object Object]","super","this","UTIL","defineAttributes","case-sensitive","definePrivateMethods","hideAllOptions","Array","from","options","forEach","option","setAttribute","clearFilter","optionsElement","hasFilter","removeFilter","selectedIndex","filterInput","PRIVATE","query","inputElement","value","showAllOptions","addFilter","results","find","length","filteredOptions","hidden","open","inputKeydownHandler","evt","keySource","keydownHandler","removeAttribute","registerListeners","connected","focus","document","activeElement","stopImmediatePropagation","addEventListener","blur","removeEventListener","emit","click","input","inputType","includes","unHoverAllOptions","window","scroll","options.selected","detail","displayElement","state.change","name","observedAttributes","index","addOption","key","func","select","guid","injected","slot","id","defineProperty","readonly","default","appendChild","inject","customElements","define"],"mappings":"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"}